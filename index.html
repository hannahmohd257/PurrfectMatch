<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Purrfect Match ğŸ±</title>
<link rel="stylesheet" href="style.css">
</head>

<body>
<header>
  <h1>Purrfect Match<kucen>cb</kucen></h1>
</header>
<br>
<div id="instruction" class="instruction">
  Swipe left âŒ to dislike, swipe right â¤ï¸ to like!
</div>

<div class="container">

  <!-- Swipe View -->
  <div id="swipeView">
    <div class="card-stack">
      <div class="card behind-2">
        <img id="catImage3">
      </div>
      <div class="card behind-1">
        <img id="catImage2">
      </div>
      <div class="card active">
        <img id="catImage">
        <div id="heartPopup" class="heartPopup">â¤ï¸</div>
        <div id="headShake" class="headShake">ğŸ™‚â€â†”ï¸</div>
      </div>
    </div>
  
    <button class="likesButton" onclick="showLikes()">â¤ï¸ Liked Cats</button>
  </div>

  <!-- Liked Cats View -->
  <div id="likesView" class="hidden">
    <h2>Liked Cats â¤ï¸</h2><button onclick="back()" class="backButton">â¬… Back</button>
    <div class="gallery" id="gallery"></div>
    <button onclick="back()" class="backButton">â¬… Back</button>
  </div>

</div>

<script>
const catImage = document.getElementById("catImage");
const swipeView = document.getElementById("swipeView");
const likesView = document.getElementById("likesView");
const gallery = document.getElementById("gallery");

let startX = 0;
let endX = 0;

// Load a random cat image
const cat1 = document.getElementById("catImage");
const cat2 = document.getElementById("catImage2");
const cat3 = document.getElementById("catImage3");

function randomCat() {
  return "https://cataas.com/cat?width=400&height=400&random=" + Date.now() + Math.random();
}

function loadInitialCats() {
  cat1.src = randomCat();
  cat2.src = randomCat();
  cat3.src = randomCat();
}

function rotateCards() {
  // Move images forward
  cat1.src = cat2.src;
  cat2.src = cat3.src;
  cat3.src = randomCat();
}


// Like a cat
function like() {
  showHeartPopup();
  let likedCats = JSON.parse(localStorage.getItem("likedCats")) || [];
  likedCats.push(cat1.src);
  localStorage.setItem("likedCats", JSON.stringify(likedCats));
  rotateCards();
}

// Dislike a cat
function dislike() {
  showHeadShake();
  rotateCards();
}

// Show heart popup briefly
function showHeartPopup() {
  const heart = document.getElementById("heartPopup");
  heart.style.transform = "translate(-50%, -50%) scale(1)";
  heart.style.opacity = 1;
  setTimeout(() => {
    heart.style.transform = "translate(-50%, -50%) scale(0)";
    heart.style.opacity = 0;
  }, 500);
}

// Show head shake briefly
function showHeadShake() {
  const headShake = document.getElementById("headShake");
  headShake.style.transform = "translate(-50%, -50%) scale(1)";
  headShake.style.opacity = 1;
  setTimeout(() => {
    headShake.style.transform = "translate(-50%, -50%) scale(0)";
    headShake.style.opacity = 0;
  }, 500);
}


// Handle swipe logic
// function handleSwipe() {
//   const diff = endX - startX;
//   if (diff > 80) swipeAnimation(300, like);       // Swipe right
//   else if (diff < -80) swipeAnimation(-300, dislike); // Swipe left
// }
let isDragging = false; // track if user is dragging

// Start dragging
catImage.addEventListener("mousedown", startDrag);
catImage.addEventListener("touchstart", startDrag);

function startDrag(e) {
  isDragging = true;
  startX = e.type === "mousedown" ? e.clientX : e.touches[0].clientX;
}

// While dragging
catImage.addEventListener("mousemove", dragMove);
catImage.addEventListener("touchmove", dragMove);

function dragMove(e) {
  if (!isDragging) return;

  endX = e.type === "mousemove" ? e.clientX : e.touches[0].clientX;
  const diff = endX - startX;

  // Update image position in real-time
  catImage.style.transform = `translateX(${diff}px) rotate(${diff / 10}deg)`;
}

// End dragging
catImage.addEventListener("mouseup", endDrag);
catImage.addEventListener("mouseleave", endDrag);
catImage.addEventListener("touchend", endDrag);

function endDrag(e) {
  if (!isDragging) return;
  isDragging = false;

  const diff = endX - startX;
  catImage.style.transition = "transform 0.3s ease"; // smooth snap back or swipe
  if (diff > 80) {
    swipeAnimation(diff, like);
  } else if (diff < -80) {
    swipeAnimation(diff, dislike);
  } else {
    // Small movement, snap back to center
    catImage.style.transform = "";
  }

  // Remove transition after animation
  setTimeout(() => {
    catImage.style.transition = "";
  }, 300);
}

// Animate swipe
function swipeAnimation(distance, callback) {
  catImage.style.transform = `translateX(${distance}px) rotate(${distance / 10}deg)`;
  catImage.style.opacity = 0;

  setTimeout(() => {
    callback(); // rotate images AFTER swipe
    catImage.style.transform = "";
    catImage.style.opacity = 1;
  }, 300);
}


// Show liked cats view
function showLikes() {
  swipeView.classList.add("hidden");
  likesView.classList.remove("hidden");
  renderLikes();
}

// Back to swipe view
function back() {
  likesView.classList.add("hidden");
  swipeView.classList.remove("hidden");
}

// Render liked cats gallery
function renderLikes() {
  gallery.innerHTML = "";
  const likedCats = JSON.parse(localStorage.getItem("likedCats")) || [];
  likedCats.forEach(url => {
    const img = document.createElement("img");
    img.src = url;
    img.className = "galleryImg";
    gallery.appendChild(img);
  });
}

// Initial load
loadInitialCats();

// Show instructions briefly on page load
window.addEventListener("load", () => {
  const instruction = document.getElementById("instruction");
  setTimeout(() => {
    instruction.classList.add("hidden");
  }, 3000); // hides after 3 seconds
});

</script>

</body>
</html>
